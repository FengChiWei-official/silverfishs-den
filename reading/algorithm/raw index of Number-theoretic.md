## 算法竞赛常用的数论结论

### 1. **欧拉函数 φ(n)**
- **定义**：1 到 n 中与 n 互质的数的个数
- **公式**：$\varphi(n) = n \prod_{p|n} (1 - \frac{1}{p})$（p 是 n 的质因子）
- **性质**：
  - φ(p) = p - 1（p 是质数）
  - φ(p^k) = p^(k-1)(p-1)
  - φ 是积性函数：若 gcd(m,n)=1，则 φ(mn) = φ(m)φ(n)
- **应用**：数一下与某数互质的数、快速幂、RSA 加密

### 2. **莫比乌斯函数 μ(n)**
- **定义**：
  - μ(n) = 1（n 是偶数个不同质数的乘积）
  - μ(n) = -1（n 是奇数个不同质数的乘积）
  - μ(n) = 0（n 有平方因子）
- **应用**：莫比乌斯反演、容斥原理

### 3. **迪利克雷卷积与莫比乌斯反演**
- 若 $f(n) = \sum_{d|n} g(d)$，则 $g(n) = \sum_{d|n} \mu(\frac{n}{d}) f(d)$
- **应用**：计算互质对数、最大公约数相关问题

---

### 4. **质数相关**

#### 线性筛（欧拉筛）
- 在 O(n) 时间内筛出所有不超过 n 的质数
- 同时可以预处理 φ 值、μ 值等

#### 质因数分解
- 试除法：O(√n)
- 关键优化：只需检查到 √n 的质数

#### 威尔逊定理
- (p-1)! ≡ -1 (mod p)，当 p 是质数

---

### 5. **模运算相关**

#### 费马小定理
- 若 p 是质数，gcd(a, p) = 1，则 $a^{p-1} \equiv 1 \pmod{p}$
- **推论**：$a^p \equiv a \pmod{p}$（对所有 a 成立）
- **应用**：快速幂取模、求模逆元

#### 扩展欧几里得算法
- 求解 ax + by = gcd(a, b)
- **应用**：求模逆元、解线性同余方程

#### 中国剩余定理（CRT）
- 求解同余方程组（互质模数）
- **应用**：合并同余条件、快速计算

---

### 6. **最大公约数（GCD）相关**

#### 欧几里得算法
- gcd(a, b) = gcd(b, a mod b)
- 时间复杂度：O(log min(a, b))

#### 最小公倍数（LCM）
- lcm(a, b) = ab / gcd(a, b)

#### 常见性质
- gcd(a, b, c) = gcd(gcd(a, b), c)
- gcd(a, b) 的所有倍数 = a 和 b 的线性组合

---

### 7. **数学函数相关**

#### 约数和函数 σ(n)
- σ(n) = Σ_{d|n} d
- σ(mn) = σ(m)σ(n)（当 gcd(m,n)=1）

#### 约数个数函数 τ(n)
- τ(n) = n 的约数个数
- 若 $n = p_1^{a_1} \cdot p_2^{a_2} \cdots p_k^{a_k}$，则 τ(n) = (a₁+1)(a₂+1)...(aₖ+1)

#### 积性函数
- 若 f(mn) = f(m)f(n)（gcd(m,n)=1），则 f 是积性函数
- 例：φ(n), μ(n), σ(n), τ(n)

---

### 8. **同余方程**

#### 一次同余方程
- ax ≡ b (mod m) 有解 ⟺ gcd(a, m) | b
- 解数为 gcd(a, m)

#### 高次同余方程
- 通常分解为质数幂的情况逐一求解

#### 二次剩余
- 判定 x² ≡ a (mod p) 是否有解（勒让德符号）

---

### 9. **组合数论**

#### 卢卡斯定理
- $\binom{n}{m} \equiv \prod_{i=0}^{k} \binom{n_i}{m_i} \pmod{p}$（p 是质数，n_i 是 n 的 p 进制数字）
- **应用**：计算大组合数对质数取模

#### 容斥原理
- 计算满足至少一个条件的对象数
- 通常配合莫比乌斯函数使用

---

### 10. **特殊技巧**

#### 辗转相除法的推广
- 求 gcd 的同时记录系数（扩展欧几里得）

#### 快速幂
- 二进制幂运算，O(log n)

#### 分块（Block）
- 处理 Σ_{i=1}^{n} ⌊n/i⌋ 这类问题

---

### 这些在竞赛中常见的模板

```cpp
// 1. 欧拉函数
int phi(int n) {
    int ans = n;
    for (int i = 2; i * i <= n; i++) {
        if (n % i == 0) {
            ans = ans / i * (i - 1);
            while (n % i == 0) n /= i;
        }
    }
    if (n > 1) ans = ans / n * (n - 1);
    return ans;
}

// 2. 快速幂
long long power(long long a, long long b, long long mod) {
    long long res = 1;
    a %= mod;
    while (b > 0) {
        if (b & 1) res = res * a % mod;
        a = a * a % mod;
        b >>= 1;
    }
    return res;
}

// 3. 扩展欧几里得
long long extgcd(long long a, long long b, long long &x, long long &y) {
    if (b == 0) {
        x = 1; y = 0;
        return a;
    }
    long long x1, y1;
    long long g = extgcd(b, a % b, x1, y1);
    x = y1;
    y = x1 - (a / b) * y1;
    return g;
}
```

这些是竞赛最常用的数论工具，掌握它们能解决大部分数论问题！